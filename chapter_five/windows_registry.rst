第 5 章 Windows 注册表
======================

注册表根路径:

* HKEY_CLASSES_ROOT
* HKEY_CURRENT_CONFIG
* HKEY_CURRENT_USER
* HKEY_LOCAL_MACHINE
* HKEY_USERS

5.1 创建项
----------

``RegCreateKeyEx()``

参数列表:

+----------------------+----------+-----------------------+--------------------------------------+
| 参数名               | 输入输出 | 类型                  | 说明                                 |
+======================+==========+=======================+======================================+
| hKey                 | IN       | HKEY                  | 注册表根路径，或者其他注册表项 [1]_  |
+----------------------+----------+-----------------------+--------------------------------------+
| lpSubKey             | IN       | LPCTSTR               | 子路径                               |
+----------------------+----------+-----------------------+--------------------------------------+
| Reserved             | IN       | DWORD                 | 赋 0 即可                            |
+----------------------+----------+-----------------------+--------------------------------------+
| lpClass              | IN, OUT  | LPCTSTR               | 用户指定类别，可赋 NULL [2]_         |
+----------------------+----------+-----------------------+--------------------------------------+
| dwOptions            | IN       | DWORD                 | REG_OPTION_NON_VOLATILE 表示永久保留 |
+----------------------+----------+-----------------------+--------------------------------------+
| samDesired           | IN       | DWORD                 | 访问权限，如 KEY_ALL_ACCESS [3]_     |
+----------------------+----------+-----------------------+--------------------------------------+
| lpSecurityAttributes | IN       | LPSECURITY_ATTRIBUTES | 赋 NULL 即可                         |
+----------------------+----------+-----------------------+--------------------------------------+
| phkResult            | OUT      | PHKEY                 | 输出 HKEY 句柄                       |
+----------------------+----------+-----------------------+--------------------------------------+
| lpdwDisposition      | OUT      | LPDWORD               | 为 NULL 即可                         |
+----------------------+----------+-----------------------+--------------------------------------+

5.2 查询项
----------

``RegQueryValueEx()``

参数列表:

+-------------+----------+---------+-----------------------------------+
| 参数名      | 输入输出 | 类型    | 说明                              |
+=============+==========+=========+===================================+
| hKey        | IN       | HKEY    | 注册表句柄或者注册表根路径        |
+-------------+----------+---------+-----------------------------------+
| lpValueName | IN       | LPCTSTR | 指定路径下的键名                  |
+-------------+----------+---------+-----------------------------------+
| lpReserved  | ``----`` | LPDWORD | 为 NULL 即可                      |
+-------------+----------+---------+-----------------------------------+
| lpType      | OUT      | LPDWORD | 获取键的类别，比如 REG_DWORD      |
+-------------+----------+---------+-----------------------------------+
| lpData      | OUT      | LPBYTE  | 存储键对应值                      |
+-------------+----------+---------+-----------------------------------+
| lpcbData    | IN,OUT   | LPDWORD | lpData 的最大字节数和结果的字节数 |
+-------------+----------+---------+-----------------------------------+



.. [1] 如果是其他注册表项的句柄，则相当于它的子项
.. [2] 预定义的类型有 REG_DWORD, REG_SZ 等
.. [3] 如果提供注册表项查询功能，需要给访问权限：KEY_QUERY_VALUE